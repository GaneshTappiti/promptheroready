/*! For license information please see 9047.e59fe77e.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkpromptheroready=self.webpackChunkpromptheroready||[]).push([[9047],{65469:(e,s,a)=>{a.d(s,{A:()=>t});const t=(0,a(77784).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},76245:(e,s,a)=>{a.d(s,{A:()=>t});const t=(0,a(77784).A)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},78187:(e,s,a)=>{a.d(s,{A:()=>b});var t=a(65043),r=a(6742),i=a(69772),n=a(8567),c=a(80764),l=a(29066),d=a(47631),o=a(51704),m=a(41736);async function h(){return await async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"super_admin";try{var a;const{data:{user:t},error:r}=await m.ND.auth.getUser();if(r||!t)return{success:!1,message:"Error getting current user: ".concat((null===r||void 0===r?void 0:r.message)||"No user found")};if((null===(a=t.email)||void 0===a?void 0:a.toLowerCase())!==e.toLowerCase())return{success:!1,message:"You can only set up admin access for your own account. Current email: ".concat(t.email)};const{data:i,error:n}=await m.ND.from("admin_users").select("*").eq("user_id",t.id).single();if(n&&"PGRST116"!==n.code)return{success:!1,message:"Error checking existing admin status: ".concat(n.message)};if(i)return{success:!1,message:"User ".concat(e," is already an admin with role: ").concat(i.role)};const{data:c,error:l}=await m.ND.from("admin_users").insert([{user_id:t.id,role:s,is_active:!0,created_by:t.id}]).select().single();return l?{success:!1,message:"Error creating admin user: ".concat(l.message)}:{success:!0,message:"Successfully granted ".concat(s," access to ").concat(e),data:c}}catch(t){return console.error("Error setting up admin by email:",t),{success:!1,message:"Unexpected error: ".concat(t.message)}}}("ganeshtappiti1605@gmail.com","super_admin")}var x=a(14459),u=a(42489),g=a(82054),p=a(37719),j=a(22024),N=a(50516),w=a(70579);const b=()=>{const{user:e}=(0,l.A)(),{isAdmin:s,isSuperAdmin:a,refreshAdminStatus:m}=(0,d.z8)(),{toast:b}=(0,o.dj)(),[y,f]=(0,t.useState)(!1);if(!e)return(0,w.jsx)(r.Zp,{className:"workspace-card",children:(0,w.jsxs)(r.Wu,{className:"p-8 text-center",children:[(0,w.jsx)(x.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,w.jsx)("h3",{className:"text-lg font-medium text-white mb-2",children:"Authentication Required"}),(0,w.jsx)("p",{className:"text-gray-400",children:"Please sign in to verify admin access."})]})});const v=(A=e.email||"",["ganeshtappiti1605@gmail.com"].includes(A.toLowerCase()));var A;return(0,w.jsxs)(r.Zp,{className:"workspace-card",children:[(0,w.jsx)(r.aR,{children:(0,w.jsxs)(r.ZB,{className:"text-white flex items-center gap-2",children:[(0,w.jsx)(u.A,{className:"h-5 w-5 text-green-400"}),"Admin Access Verification"]})}),(0,w.jsxs)(r.Wu,{className:"space-y-4",children:[(0,w.jsx)("div",{className:"p-3 bg-black/20 rounded-lg border border-white/10",children:(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("p",{className:"text-white font-medium",children:"Current User"}),(0,w.jsx)("p",{className:"text-gray-400 text-sm",children:e.email})]}),(0,w.jsxs)("div",{className:"flex items-center gap-2",children:[v&&(0,w.jsx)(n.E,{variant:"outline",className:"border-blue-500/30 bg-blue-500/10 text-blue-400",children:"Predefined Admin"}),s&&(0,w.jsxs)(n.E,{variant:"outline",className:"border-green-500/30 bg-green-500/10 text-green-400",children:[(0,w.jsx)(u.A,{className:"h-3 w-3 mr-1"}),a?"Super Admin":"Admin"]})]})]})}),(0,w.jsxs)(c.Fc,{className:"".concat(s?"border-green-600/20 bg-green-600/10":"border-yellow-600/20 bg-yellow-600/10"),children:[s?(0,w.jsx)(g.A,{className:"h-4 w-4 text-green-400"}):(0,w.jsx)(p.A,{className:"h-4 w-4 text-yellow-400"}),(0,w.jsx)(c.TN,{className:s?"text-green-200":"text-yellow-200",children:s?(0,w.jsxs)("span",{children:[(0,w.jsx)("strong",{children:"Admin Access Active:"})," You have ",a?"super admin":"admin"," privileges."]}):v?(0,w.jsxs)("span",{children:[(0,w.jsx)("strong",{children:"Admin Setup Available:"})," Your email is configured for admin access. Click the button below to activate admin privileges."]}):(0,w.jsxs)("span",{children:[(0,w.jsx)("strong",{children:"No Admin Access:"})," Your account does not have admin privileges."]})})]}),(0,w.jsxs)("div",{className:"flex gap-3",children:[v&&!s&&(0,w.jsxs)(i.$,{onClick:async()=>{if(e)try{f(!0);const e=await h();e.success?(b({title:"Success",description:e.message}),await m()):b({title:"Error",description:e.message,variant:"destructive"})}catch(s){console.error("Error setting up predefined admin:",s),b({title:"Error",description:(null===s||void 0===s?void 0:s.message)||"Failed to set up admin access",variant:"destructive"})}finally{f(!1)}else b({title:"Error",description:"You must be logged in to set up admin access",variant:"destructive"})},disabled:y,className:"bg-green-600 hover:bg-green-700 text-white",children:[y?(0,w.jsx)(j.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,w.jsx)(u.A,{className:"mr-2 h-4 w-4"}),"Activate Admin Access"]}),(0,w.jsxs)(i.$,{onClick:async()=>{f(!0),await m(),f(!1),b({title:"Status Refreshed",description:"Admin status has been updated"})},disabled:y,variant:"outline",className:"border-white/20 text-white hover:bg-white/10",children:[y?(0,w.jsx)(j.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,w.jsx)(N.A,{className:"mr-2 h-4 w-4"}),"Refresh Status"]})]}),s&&(0,w.jsx)("div",{className:"pt-3 border-t border-white/10",children:(0,w.jsx)(i.$,{asChild:!0,className:"w-full bg-blue-600 hover:bg-blue-700 text-white",children:(0,w.jsxs)("a",{href:"/admin",children:[(0,w.jsx)(u.A,{className:"mr-2 h-4 w-4"}),"Go to Admin Panel"]})})})]})]})}},82054:(e,s,a)=>{a.d(s,{A:()=>t});const t=(0,a(77784).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},89047:(e,s,a)=>{a.r(s),a.d(s,{default:()=>k});var t=a(65043),r=a(35475),i=a(6742),n=a(69772),c=a(8567),l=a(29066),d=a(47631),o=a(78187),m=a(41736);async function h(){try{const{data:e,error:s}=await m.ND.from("admin_users").select("count").limit(1);return s?{component:"Supabase Connection",status:"error",message:"Database connection failed: ".concat(s.message),details:s}:{component:"Supabase Connection",status:"healthy",message:"Database connection successful"}}catch(e){return{component:"Supabase Connection",status:"error",message:"Connection error: ".concat(e.message),details:e}}}async function x(){try{const e=["admin_users","prompt_templates","ai_tools_directory","platform_settings"],s=[];for(const a of e){const{error:e}=await m.ND.from(a).select("count").limit(1);e&&s.push({table:a,error:e.message})}return s.length>0?{component:"Admin Tables",status:"error",message:"Missing or inaccessible tables: ".concat(s.map(e=>e.table).join(", ")),details:s}:{component:"Admin Tables",status:"healthy",message:"All admin tables accessible"}}catch(e){return{component:"Admin Tables",status:"error",message:"Table check failed: ".concat(e.message),details:e}}}async function u(){try{var e;const{data:{user:s}}=await m.ND.auth.getUser();if(!s)return{component:"Admin Setup",status:"warning",message:"No user logged in - cannot check admin setup"};const a="ganeshtappiti1605@gmail.com";if((null===(e=s.email)||void 0===e?void 0:e.toLowerCase())===a.toLowerCase()){const{data:e,error:a}=await m.ND.from("admin_users").select("*").eq("user_id",s.id).single();return a&&"PGRST116"!==a.code?{component:"Admin Setup",status:"error",message:"Error checking admin status: ".concat(a.message),details:a}:e?{component:"Admin Setup",status:"healthy",message:"Admin access already configured for ".concat(s.email," with role: ").concat(e.role)}:{component:"Admin Setup",status:"warning",message:"Predefined admin email ".concat(s.email," is logged in but admin access not yet configured")}}return{component:"Admin Setup",status:"healthy",message:"Current user (".concat(s.email,") is not the predefined admin email")}}catch(s){return{component:"Admin Setup",status:"error",message:"Admin setup check failed: ".concat(s.message),details:s}}}function g(e){return e.some(e=>"error"===e.status)?"error":e.some(e=>"warning"===e.status)?"warning":"healthy"}var p=a(65469),j=a(42489),N=a(82054),w=a(76245),b=a(7365),y=a(37719),f=a(50516),v=a(23658),A=a(70579);const k=()=>{var e;const{user:s}=(0,l.A)(),{isAdmin:a,isSuperAdmin:m,adminUser:k,loading:C}=(0,d.z8)(),[S,E]=(0,t.useState)([]),[_,R]=(0,t.useState)(!1),T=async()=>{R(!0);try{const e=await async function(){const e=[h(),x(),u()];return Promise.all(e)}();E(e)}catch(e){console.error("Health check failed:",e)}finally{R(!1)}};return(0,t.useEffect)(()=>{T()},[]),(0,A.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-green-900 to-black p-6",children:(0,A.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,A.jsxs)("div",{className:"flex items-center justify-between",children:[(0,A.jsxs)("div",{children:[(0,A.jsx)("h1",{className:"text-3xl font-bold text-white",children:"Admin Access Test"}),(0,A.jsx)("p",{className:"text-gray-400 mt-1",children:"Test and verify admin access for ganeshtappiti1605@gmail.com"})]}),(0,A.jsx)(n.$,{asChild:!0,variant:"outline",className:"border-white/20 text-white hover:bg-white/10",children:(0,A.jsxs)(r.N_,{to:"/workspace",children:[(0,A.jsx)(p.A,{className:"h-4 w-4 mr-2"}),"Back to Workspace"]})})]}),(0,A.jsxs)(i.Zp,{className:"workspace-card",children:[(0,A.jsx)(i.aR,{children:(0,A.jsxs)(i.ZB,{className:"text-white flex items-center gap-2",children:[(0,A.jsx)(j.A,{className:"h-5 w-5 text-green-400"}),"Current Status"]})}),(0,A.jsx)(i.Wu,{className:"space-y-4",children:(0,A.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,A.jsxs)("div",{className:"space-y-3",children:[(0,A.jsx)("h3",{className:"text-white font-medium",children:"User Information"}),(0,A.jsxs)("div",{className:"space-y-2",children:[(0,A.jsxs)("div",{className:"flex justify-between",children:[(0,A.jsx)("span",{className:"text-gray-400",children:"Email:"}),(0,A.jsx)("span",{className:"text-white",children:(null===s||void 0===s?void 0:s.email)||"Not logged in"})]}),(0,A.jsxs)("div",{className:"flex justify-between",children:[(0,A.jsx)("span",{className:"text-gray-400",children:"User ID:"}),(0,A.jsxs)("span",{className:"text-white text-xs",children:[(null===s||void 0===s||null===(e=s.id)||void 0===e?void 0:e.slice(0,8))||"N/A","..."]})]}),(0,A.jsxs)("div",{className:"flex justify-between",children:[(0,A.jsx)("span",{className:"text-gray-400",children:"Expected Admin:"}),(0,A.jsx)("span",{className:"text-white",children:"ganeshtappiti1605@gmail.com"===(null===s||void 0===s?void 0:s.email)?(0,A.jsxs)(c.E,{variant:"outline",className:"border-green-500/30 bg-green-500/10 text-green-400",children:[(0,A.jsx)(N.A,{className:"h-3 w-3 mr-1"}),"Yes"]}):(0,A.jsxs)(c.E,{variant:"outline",className:"border-red-500/30 bg-red-500/10 text-red-400",children:[(0,A.jsx)(w.A,{className:"h-3 w-3 mr-1"}),"No"]})})]})]})]}),(0,A.jsxs)("div",{className:"space-y-3",children:[(0,A.jsx)("h3",{className:"text-white font-medium",children:"Admin Status"}),(0,A.jsxs)("div",{className:"space-y-2",children:[(0,A.jsxs)("div",{className:"flex justify-between",children:[(0,A.jsx)("span",{className:"text-gray-400",children:"Loading:"}),(0,A.jsx)("span",{className:"text-white",children:C?"Yes":"No"})]}),(0,A.jsxs)("div",{className:"flex justify-between",children:[(0,A.jsx)("span",{className:"text-gray-400",children:"Is Admin:"}),(0,A.jsx)("span",{className:"text-white",children:a?(0,A.jsxs)(c.E,{variant:"outline",className:"border-green-500/30 bg-green-500/10 text-green-400",children:[(0,A.jsx)(N.A,{className:"h-3 w-3 mr-1"}),"Yes"]}):(0,A.jsxs)(c.E,{variant:"outline",className:"border-red-500/30 bg-red-500/10 text-red-400",children:[(0,A.jsx)(w.A,{className:"h-3 w-3 mr-1"}),"No"]})})]}),(0,A.jsxs)("div",{className:"flex justify-between",children:[(0,A.jsx)("span",{className:"text-gray-400",children:"Role:"}),(0,A.jsx)("span",{className:"text-white",children:(null===k||void 0===k?void 0:k.role)||"None"})]}),(0,A.jsxs)("div",{className:"flex justify-between",children:[(0,A.jsx)("span",{className:"text-gray-400",children:"Super Admin:"}),(0,A.jsx)("span",{className:"text-white",children:m?"Yes":"No"})]})]})]})]})})]}),(0,A.jsxs)(i.Zp,{className:"workspace-card",children:[(0,A.jsx)(i.aR,{children:(0,A.jsxs)(i.ZB,{className:"text-white flex items-center gap-2",children:[(0,A.jsx)(b.A,{className:"h-5 w-5 text-blue-400"}),"System Health Check",S.length>0&&(0,A.jsxs)(c.E,{variant:"outline",className:"ml-auto ".concat("healthy"===g(S)?"border-green-500/30 bg-green-500/10 text-green-400":"warning"===g(S)?"border-yellow-500/30 bg-yellow-500/10 text-yellow-400":"border-red-500/30 bg-red-500/10 text-red-400"),children:["healthy"===g(S)&&(0,A.jsx)(N.A,{className:"h-3 w-3 mr-1"}),"warning"===g(S)&&(0,A.jsx)(y.A,{className:"h-3 w-3 mr-1"}),"error"===g(S)&&(0,A.jsx)(w.A,{className:"h-3 w-3 mr-1"}),g(S)]})]})}),(0,A.jsx)(i.Wu,{className:"space-y-3",children:_?(0,A.jsxs)("div",{className:"text-center py-4",children:[(0,A.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-400 mx-auto"}),(0,A.jsx)("p",{className:"text-gray-400 mt-2",children:"Running health checks..."})]}):(0,A.jsxs)("div",{className:"space-y-2",children:[S.map((e,s)=>(0,A.jsxs)("div",{className:"p-3 rounded-lg border ".concat("healthy"===e.status?"bg-green-600/10 border-green-600/20":"warning"===e.status?"bg-yellow-600/10 border-yellow-600/20":"bg-red-600/10 border-red-600/20"),children:[(0,A.jsxs)("div",{className:"flex items-center justify-between",children:[(0,A.jsx)("span",{className:"text-white font-medium",children:e.component}),(0,A.jsx)(c.E,{variant:"outline",className:"".concat("healthy"===e.status?"border-green-500/30 bg-green-500/10 text-green-400":"warning"===e.status?"border-yellow-500/30 bg-yellow-500/10 text-yellow-400":"border-red-500/30 bg-red-500/10 text-red-400"),children:e.status})]}),(0,A.jsx)("p",{className:"text-gray-400 text-sm mt-1",children:e.message})]},s)),(0,A.jsxs)(n.$,{onClick:T,variant:"outline",className:"w-full border-white/20 text-white hover:bg-white/10 mt-3",disabled:_,children:[(0,A.jsx)(f.A,{className:"h-4 w-4 mr-2"}),"Refresh Health Check"]})]})})]}),(0,A.jsx)(o.A,{}),(0,A.jsxs)(i.Zp,{className:"workspace-card",children:[(0,A.jsx)(i.aR,{children:(0,A.jsx)(i.ZB,{className:"text-white",children:"Quick Actions"})}),(0,A.jsx)(i.Wu,{className:"space-y-3",children:(0,A.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,A.jsx)(n.$,{asChild:!0,variant:"outline",className:"border-white/20 text-white hover:bg-white/10",children:(0,A.jsxs)(r.N_,{to:"/admin-setup",children:[(0,A.jsx)(b.A,{className:"h-4 w-4 mr-2"}),"Admin Setup"]})}),a&&(0,A.jsx)(n.$,{asChild:!0,className:"bg-green-600 hover:bg-green-700 text-white",children:(0,A.jsxs)(r.N_,{to:"/admin",children:[(0,A.jsx)(j.A,{className:"h-4 w-4 mr-2"}),"Admin Panel"]})}),(0,A.jsx)(n.$,{asChild:!0,variant:"outline",className:"border-white/20 text-white hover:bg-white/10",children:(0,A.jsxs)(r.N_,{to:"/workspace",children:[(0,A.jsx)(v.A,{className:"h-4 w-4 mr-2"}),"Workspace"]})})]})})]}),(0,A.jsxs)(i.Zp,{className:"workspace-card",children:[(0,A.jsx)(i.aR,{children:(0,A.jsx)(i.ZB,{className:"text-white",children:"Instructions"})}),(0,A.jsx)(i.Wu,{children:(0,A.jsxs)("div",{className:"space-y-3 text-gray-300",children:[(0,A.jsx)("p",{children:(0,A.jsx)("strong",{children:"For ganeshtappiti1605@gmail.com:"})}),(0,A.jsxs)("ol",{className:"list-decimal list-inside space-y-2 ml-4",children:[(0,A.jsx)("li",{children:"Sign in with the admin email address"}),(0,A.jsx)("li",{children:"The system should automatically detect and grant admin access"}),(0,A.jsx)("li",{children:'If not automatic, click "Activate Admin Access" in the verification section above'}),(0,A.jsx)("li",{children:"Once admin access is active, you can access the admin panel"}),(0,A.jsx)("li",{children:'Use the "Admin Panel" link in the sidebar or the button above'})]}),(0,A.jsx)("p",{className:"mt-4",children:(0,A.jsx)("strong",{children:"Troubleshooting:"})}),(0,A.jsxs)("ul",{className:"list-disc list-inside space-y-1 ml-4",children:[(0,A.jsx)("li",{children:"Make sure you're signed in with the correct email"}),(0,A.jsx)("li",{children:"Try refreshing the page if admin status doesn't update"}),(0,A.jsx)("li",{children:"Check the browser console for any errors"}),(0,A.jsx)("li",{children:'Use the "Refresh Status" button to manually update admin status'})]})]})})]})]})})}}}]);
//# sourceMappingURL=9047.e59fe77e.chunk.js.map