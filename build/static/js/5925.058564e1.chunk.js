"use strict";(self.webpackChunkpromptheroready=self.webpackChunkpromptheroready||[]).push([[5925],{15925:(e,s,t)=>{t.r(s),t.d(s,{default:()=>g});var r=t(89379),a=t(9950),n=t(16255),c=t(60348),l=t(38493),i=t(94208),x=t(32180),o=t(27549),d=t(27255),h=t(66987),m=t(14215),u=t(6890),p=t(19201),j=t(61041),N=t(29975),f=t(45833),w=t(15924),v=t(44414);const g=()=>{const{checkPermission:e}=(0,x.z8)(),[s,t]=(0,a.useState)({totalSubscribers:0,freeUsers:0,paidUsers:0,trialUsers:0,mrr:0,arr:0,churnRate:0,conversionRate:0,planBreakdown:[],revenueGrowth:{monthly:0,quarterly:0,yearly:0},countryRevenue:[]}),[g,y]=(0,a.useState)(!0);(0,a.useEffect)(()=>{b()},[]);const b=async()=>{try{y(!0);const{data:e,error:s}=await o.ND.from("user_settings").select("subscription_tier, subscription_status, created_at, settings").not("user_id","is",null);if(s)throw s;const a=(null===e||void 0===e?void 0:e.length)||0,n=(null===e||void 0===e?void 0:e.filter(e=>"free"===e.subscription_tier).length)||0,c=(null===e||void 0===e?void 0:e.filter(e=>"free"!==e.subscription_tier&&"active"===e.subscription_status).length)||0,l=(null===e||void 0===e?void 0:e.filter(e=>"trial"===e.subscription_status).length)||0,i=(null===e||void 0===e?void 0:e.reduce((e,s)=>{const t=s.subscription_tier||"free";return e[t]=(e[t]||0)+1,e},{}))||{},x={free:0,starter:999,pro:2999,enterprise:9999},d=Object.entries(i).map(e=>{let[s,t]=e;return{plan:s.charAt(0).toUpperCase()+s.slice(1),users:t,revenue:t*(x[s]||0),percentage:t/a*100}}),h=d.reduce((e,s)=>e+s.revenue,0),m=12*h,u={churnRate:5.2,conversionRate:12.8,revenueGrowth:{monthly:15.3,quarterly:42.7,yearly:156.8},countryRevenue:[{country:"India",revenue:Math.floor(.4*h),users:Math.floor(.4*c)},{country:"United States",revenue:Math.floor(.3*h),users:Math.floor(.3*c)},{country:"United Kingdom",revenue:Math.floor(.15*h),users:Math.floor(.15*c)},{country:"Canada",revenue:Math.floor(.1*h),users:Math.floor(.1*c)},{country:"Others",revenue:Math.floor(.05*h),users:Math.floor(.05*c)}]};t((0,r.A)({totalSubscribers:a,freeUsers:n,paidUsers:c,trialUsers:l,mrr:h,arr:m,planBreakdown:d},u))}catch(e){console.error("Error fetching subscription data:",e)}finally{y(!1)}};return g?(0,v.jsxs)("div",{className:"space-y-6",children:[(0,v.jsxs)("div",{className:"flex items-center justify-between",children:[(0,v.jsx)("h1",{className:"text-3xl font-bold text-white",children:"Subscription Analytics"}),(0,v.jsx)("div",{className:"animate-pulse h-8 w-32 bg-white/10 rounded"})]}),(0,v.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[...Array(8)].map((e,s)=>(0,v.jsx)(n.Zp,{className:"workspace-card animate-pulse",children:(0,v.jsx)(n.Wu,{className:"p-6",children:(0,v.jsx)("div",{className:"h-16 bg-white/10 rounded"})})},s))})]}):(0,v.jsxs)("div",{className:"space-y-6",children:[(0,v.jsxs)("div",{className:"flex items-center justify-between",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("h1",{className:"text-3xl font-bold text-white",children:"Subscription Analytics"}),(0,v.jsx)("p",{className:"text-gray-400 mt-1",children:"Revenue metrics and subscription performance"})]}),(0,v.jsxs)("div",{className:"flex items-center gap-2",children:[(0,v.jsxs)(l.$,{onClick:()=>{const e=[["Plan","Users","Revenue (INR)","Percentage"],...s.planBreakdown.map(e=>[e.plan,e.users.toString(),e.revenue.toString(),e.percentage.toFixed(1)+"%"])].map(e=>e.join(",")).join("\n"),t=new Blob([e],{type:"text/csv"}),r=window.URL.createObjectURL(t),a=document.createElement("a");a.href=r,a.download="subscription-analytics-".concat((new Date).toISOString().split("T")[0],".csv"),a.click(),window.URL.revokeObjectURL(r)},variant:"outline",size:"sm",className:"border-white/20 text-white hover:bg-white/10",children:[(0,v.jsx)(d.A,{className:"mr-2 h-4 w-4"}),"Export"]}),(0,v.jsxs)(l.$,{onClick:b,variant:"outline",size:"sm",className:"border-white/20 text-white hover:bg-white/10",children:[(0,v.jsx)(h.A,{className:"mr-2 h-4 w-4"}),"Refresh"]})]})]}),(0,v.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[(0,v.jsxs)(n.Zp,{className:"workspace-card",children:[(0,v.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,v.jsx)(n.ZB,{className:"text-sm font-medium text-gray-300",children:"Monthly Recurring Revenue"}),(0,v.jsx)(m.A,{className:"h-4 w-4 text-green-400"})]}),(0,v.jsxs)(n.Wu,{children:[(0,v.jsxs)("div",{className:"text-2xl font-bold text-white",children:["\u20b9",s.mrr.toLocaleString()]}),(0,v.jsxs)("p",{className:"text-xs text-green-400 flex items-center",children:[(0,v.jsx)(u.A,{className:"h-3 w-3 mr-1"}),"+",s.revenueGrowth.monthly,"% from last month"]})]})]}),(0,v.jsxs)(n.Zp,{className:"workspace-card",children:[(0,v.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,v.jsx)(n.ZB,{className:"text-sm font-medium text-gray-300",children:"Annual Recurring Revenue"}),(0,v.jsx)(p.A,{className:"h-4 w-4 text-green-400"})]}),(0,v.jsxs)(n.Wu,{children:[(0,v.jsxs)("div",{className:"text-2xl font-bold text-white",children:["\u20b9",s.arr.toLocaleString()]}),(0,v.jsxs)("p",{className:"text-xs text-green-400 flex items-center",children:[(0,v.jsx)(u.A,{className:"h-3 w-3 mr-1"}),"+",s.revenueGrowth.yearly,"% YoY"]})]})]}),(0,v.jsxs)(n.Zp,{className:"workspace-card",children:[(0,v.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,v.jsx)(n.ZB,{className:"text-sm font-medium text-gray-300",children:"Paid Subscribers"}),(0,v.jsx)(j.A,{className:"h-4 w-4 text-green-400"})]}),(0,v.jsxs)(n.Wu,{children:[(0,v.jsx)("div",{className:"text-2xl font-bold text-white",children:s.paidUsers.toLocaleString()}),(0,v.jsxs)("p",{className:"text-xs text-gray-400",children:[s.trialUsers," on trial"]})]})]}),(0,v.jsxs)(n.Zp,{className:"workspace-card",children:[(0,v.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,v.jsx)(n.ZB,{className:"text-sm font-medium text-gray-300",children:"Conversion Rate"}),(0,v.jsx)(u.A,{className:"h-4 w-4 text-green-400"})]}),(0,v.jsxs)(n.Wu,{children:[(0,v.jsxs)("div",{className:"text-2xl font-bold text-white",children:[s.conversionRate,"%"]}),(0,v.jsx)("p",{className:"text-xs text-gray-400",children:"Free to paid conversion"})]})]})]}),(0,v.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,v.jsxs)(n.Zp,{className:"workspace-card",children:[(0,v.jsx)(n.aR,{children:(0,v.jsxs)(n.ZB,{className:"text-white flex items-center gap-2",children:[(0,v.jsx)(N.A,{className:"h-5 w-5 text-green-400"}),"Subscription Plans"]})}),(0,v.jsx)(n.Wu,{className:"space-y-4",children:s.planBreakdown.map((e,s)=>(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsxs)("div",{className:"flex items-center justify-between",children:[(0,v.jsxs)("div",{className:"flex items-center gap-2",children:[(0,v.jsx)("span",{className:"text-gray-300",children:e.plan}),(0,v.jsxs)(c.E,{variant:"secondary",className:"text-xs",children:[e.users," users"]})]}),(0,v.jsxs)("span",{className:"text-white",children:["\u20b9",e.revenue.toLocaleString(),"/mo"]})]}),(0,v.jsx)(i.k,{value:e.percentage,className:"h-2"}),(0,v.jsxs)("p",{className:"text-xs text-gray-400",children:[e.percentage.toFixed(1),"% of total users"]})]},e.plan))})]}),(0,v.jsxs)(n.Zp,{className:"workspace-card",children:[(0,v.jsx)(n.aR,{children:(0,v.jsxs)(n.ZB,{className:"text-white flex items-center gap-2",children:[(0,v.jsx)(f.A,{className:"h-5 w-5 text-green-400"}),"Health Metrics"]})}),(0,v.jsxs)(n.Wu,{className:"space-y-4",children:[(0,v.jsxs)("div",{className:"flex items-center justify-between",children:[(0,v.jsx)("span",{className:"text-gray-300",children:"Churn Rate"}),(0,v.jsxs)("div",{className:"flex items-center gap-2",children:[(0,v.jsxs)("span",{className:"text-white",children:[s.churnRate,"%"]}),s.churnRate<10?(0,v.jsx)(f.A,{className:"h-4 w-4 text-green-400"}):(0,v.jsx)(w.A,{className:"h-4 w-4 text-yellow-400"})]})]}),(0,v.jsxs)("div",{className:"flex items-center justify-between",children:[(0,v.jsx)("span",{className:"text-gray-300",children:"Customer Lifetime Value"}),(0,v.jsxs)("span",{className:"text-white",children:["\u20b9",Math.floor(s.mrr/s.paidUsers*24).toLocaleString()]})]}),(0,v.jsxs)("div",{className:"flex items-center justify-between",children:[(0,v.jsx)("span",{className:"text-gray-300",children:"Average Revenue Per User"}),(0,v.jsxs)("span",{className:"text-white",children:["\u20b9",Math.floor(s.mrr/s.paidUsers).toLocaleString()]})]}),(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsxs)("div",{className:"flex items-center justify-between",children:[(0,v.jsx)("span",{className:"text-gray-300",children:"Revenue Growth"}),(0,v.jsxs)("span",{className:"text-green-400",children:["+",s.revenueGrowth.monthly,"%"]})]}),(0,v.jsx)(i.k,{value:Math.min(s.revenueGrowth.monthly,100),className:"h-2"})]})]})]})]}),(0,v.jsxs)(n.Zp,{className:"workspace-card",children:[(0,v.jsx)(n.aR,{children:(0,v.jsxs)(n.ZB,{className:"text-white flex items-center gap-2",children:[(0,v.jsx)(m.A,{className:"h-5 w-5 text-green-400"}),"Revenue by Country"]})}),(0,v.jsx)(n.Wu,{children:(0,v.jsx)("div",{className:"space-y-4",children:s.countryRevenue.map((e,t)=>(0,v.jsxs)("div",{className:"flex items-center justify-between",children:[(0,v.jsxs)("div",{className:"flex items-center gap-3",children:[(0,v.jsx)("span",{className:"text-gray-300 min-w-[100px]",children:e.country}),(0,v.jsxs)("div",{className:"flex items-center gap-2",children:[(0,v.jsx)("div",{className:"w-32 bg-gray-700 rounded-full h-2",children:(0,v.jsx)("div",{className:"bg-green-500 h-2 rounded-full",style:{width:"".concat(e.revenue/s.mrr*100,"%")}})}),(0,v.jsxs)("span",{className:"text-xs text-gray-400",children:[e.users," users"]})]})]}),(0,v.jsxs)("span",{className:"text-white font-medium",children:["\u20b9",e.revenue.toLocaleString()]})]},e.country))})})]})]})}}}]);