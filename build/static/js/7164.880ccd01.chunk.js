"use strict";(self.webpackChunkpromptheroready=self.webpackChunkpromptheroready||[]).push([[7164],{57164:(e,s,a)=>{a.r(s),a.d(s,{default:()=>k});var t=a(9950),n=a(42074),r=a(16255),i=a(38493),c=a(60348),l=a(91367),d=a(32180),o=a(83728),m=a(27549);async function h(){try{const{data:e,error:s}=await m.ND.from("admin_users").select("count").limit(1);return s?{component:"Supabase Connection",status:"error",message:"Database connection failed: ".concat(s.message),details:s}:{component:"Supabase Connection",status:"healthy",message:"Database connection successful"}}catch(e){return{component:"Supabase Connection",status:"error",message:"Connection error: ".concat(e.message),details:e}}}async function x(){try{const e=["admin_users","prompt_templates","ai_tools_directory","platform_settings"],s=[];for(const a of e){const{error:e}=await m.ND.from(a).select("count").limit(1);e&&s.push({table:a,error:e.message})}return s.length>0?{component:"Admin Tables",status:"error",message:"Missing or inaccessible tables: ".concat(s.map(e=>e.table).join(", ")),details:s}:{component:"Admin Tables",status:"healthy",message:"All admin tables accessible"}}catch(e){return{component:"Admin Tables",status:"error",message:"Table check failed: ".concat(e.message),details:e}}}async function u(){try{var e;const{data:{user:s}}=await m.ND.auth.getUser();if(!s)return{component:"Admin Setup",status:"warning",message:"No user logged in - cannot check admin setup"};const a="ganeshtappiti1605@gmail.com";if((null===(e=s.email)||void 0===e?void 0:e.toLowerCase())===a.toLowerCase()){const{data:e,error:a}=await m.ND.from("admin_users").select("*").eq("user_id",s.id).single();return a&&"PGRST116"!==a.code?{component:"Admin Setup",status:"error",message:"Error checking admin status: ".concat(a.message),details:a}:e?{component:"Admin Setup",status:"healthy",message:"Admin access already configured for ".concat(s.email," with role: ").concat(e.role)}:{component:"Admin Setup",status:"warning",message:"Predefined admin email ".concat(s.email," is logged in but admin access not yet configured")}}return{component:"Admin Setup",status:"healthy",message:"Current user (".concat(s.email,") is not the predefined admin email")}}catch(s){return{component:"Admin Setup",status:"error",message:"Admin setup check failed: ".concat(s.message),details:s}}}function g(e){return e.some(e=>"error"===e.status)?"error":e.some(e=>"warning"===e.status)?"warning":"healthy"}var j=a(45462),p=a(81946),N=a(45833),w=a(81850),b=a(89318),y=a(15924),f=a(66987),v=a(32443),A=a(44414);const k=()=>{var e;const{user:s}=(0,l.A)(),{isAdmin:a,isSuperAdmin:m,adminUser:k,loading:S}=(0,d.z8)(),[C,_]=(0,t.useState)([]),[E,T]=(0,t.useState)(!1),R=async()=>{T(!0);try{const e=await async function(){const e=[h(),x(),u()];return Promise.all(e)}();_(e)}catch(e){console.error("Health check failed:",e)}finally{T(!1)}};return(0,t.useEffect)(()=>{R()},[]),(0,A.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-green-900 to-black p-6",children:(0,A.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,A.jsxs)("div",{className:"flex items-center justify-between",children:[(0,A.jsxs)("div",{children:[(0,A.jsx)("h1",{className:"text-3xl font-bold text-white",children:"Admin Access Test"}),(0,A.jsx)("p",{className:"text-gray-400 mt-1",children:"Test and verify admin access for ganeshtappiti1605@gmail.com"})]}),(0,A.jsx)(i.$,{asChild:!0,variant:"outline",className:"border-white/20 text-white hover:bg-white/10",children:(0,A.jsxs)(n.N_,{to:"/workspace",children:[(0,A.jsx)(j.A,{className:"h-4 w-4 mr-2"}),"Back to Workspace"]})})]}),(0,A.jsxs)(r.Zp,{className:"workspace-card",children:[(0,A.jsx)(r.aR,{children:(0,A.jsxs)(r.ZB,{className:"text-white flex items-center gap-2",children:[(0,A.jsx)(p.A,{className:"h-5 w-5 text-green-400"}),"Current Status"]})}),(0,A.jsx)(r.Wu,{className:"space-y-4",children:(0,A.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,A.jsxs)("div",{className:"space-y-3",children:[(0,A.jsx)("h3",{className:"text-white font-medium",children:"User Information"}),(0,A.jsxs)("div",{className:"space-y-2",children:[(0,A.jsxs)("div",{className:"flex justify-between",children:[(0,A.jsx)("span",{className:"text-gray-400",children:"Email:"}),(0,A.jsx)("span",{className:"text-white",children:(null===s||void 0===s?void 0:s.email)||"Not logged in"})]}),(0,A.jsxs)("div",{className:"flex justify-between",children:[(0,A.jsx)("span",{className:"text-gray-400",children:"User ID:"}),(0,A.jsxs)("span",{className:"text-white text-xs",children:[(null===s||void 0===s||null===(e=s.id)||void 0===e?void 0:e.slice(0,8))||"N/A","..."]})]}),(0,A.jsxs)("div",{className:"flex justify-between",children:[(0,A.jsx)("span",{className:"text-gray-400",children:"Expected Admin:"}),(0,A.jsx)("span",{className:"text-white",children:"ganeshtappiti1605@gmail.com"===(null===s||void 0===s?void 0:s.email)?(0,A.jsxs)(c.E,{variant:"outline",className:"border-green-500/30 bg-green-500/10 text-green-400",children:[(0,A.jsx)(N.A,{className:"h-3 w-3 mr-1"}),"Yes"]}):(0,A.jsxs)(c.E,{variant:"outline",className:"border-red-500/30 bg-red-500/10 text-red-400",children:[(0,A.jsx)(w.A,{className:"h-3 w-3 mr-1"}),"No"]})})]})]})]}),(0,A.jsxs)("div",{className:"space-y-3",children:[(0,A.jsx)("h3",{className:"text-white font-medium",children:"Admin Status"}),(0,A.jsxs)("div",{className:"space-y-2",children:[(0,A.jsxs)("div",{className:"flex justify-between",children:[(0,A.jsx)("span",{className:"text-gray-400",children:"Loading:"}),(0,A.jsx)("span",{className:"text-white",children:S?"Yes":"No"})]}),(0,A.jsxs)("div",{className:"flex justify-between",children:[(0,A.jsx)("span",{className:"text-gray-400",children:"Is Admin:"}),(0,A.jsx)("span",{className:"text-white",children:a?(0,A.jsxs)(c.E,{variant:"outline",className:"border-green-500/30 bg-green-500/10 text-green-400",children:[(0,A.jsx)(N.A,{className:"h-3 w-3 mr-1"}),"Yes"]}):(0,A.jsxs)(c.E,{variant:"outline",className:"border-red-500/30 bg-red-500/10 text-red-400",children:[(0,A.jsx)(w.A,{className:"h-3 w-3 mr-1"}),"No"]})})]}),(0,A.jsxs)("div",{className:"flex justify-between",children:[(0,A.jsx)("span",{className:"text-gray-400",children:"Role:"}),(0,A.jsx)("span",{className:"text-white",children:(null===k||void 0===k?void 0:k.role)||"None"})]}),(0,A.jsxs)("div",{className:"flex justify-between",children:[(0,A.jsx)("span",{className:"text-gray-400",children:"Super Admin:"}),(0,A.jsx)("span",{className:"text-white",children:m?"Yes":"No"})]})]})]})]})})]}),(0,A.jsxs)(r.Zp,{className:"workspace-card",children:[(0,A.jsx)(r.aR,{children:(0,A.jsxs)(r.ZB,{className:"text-white flex items-center gap-2",children:[(0,A.jsx)(b.A,{className:"h-5 w-5 text-blue-400"}),"System Health Check",C.length>0&&(0,A.jsxs)(c.E,{variant:"outline",className:"ml-auto ".concat("healthy"===g(C)?"border-green-500/30 bg-green-500/10 text-green-400":"warning"===g(C)?"border-yellow-500/30 bg-yellow-500/10 text-yellow-400":"border-red-500/30 bg-red-500/10 text-red-400"),children:["healthy"===g(C)&&(0,A.jsx)(N.A,{className:"h-3 w-3 mr-1"}),"warning"===g(C)&&(0,A.jsx)(y.A,{className:"h-3 w-3 mr-1"}),"error"===g(C)&&(0,A.jsx)(w.A,{className:"h-3 w-3 mr-1"}),g(C)]})]})}),(0,A.jsx)(r.Wu,{className:"space-y-3",children:E?(0,A.jsxs)("div",{className:"text-center py-4",children:[(0,A.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-400 mx-auto"}),(0,A.jsx)("p",{className:"text-gray-400 mt-2",children:"Running health checks..."})]}):(0,A.jsxs)("div",{className:"space-y-2",children:[C.map((e,s)=>(0,A.jsxs)("div",{className:"p-3 rounded-lg border ".concat("healthy"===e.status?"bg-green-600/10 border-green-600/20":"warning"===e.status?"bg-yellow-600/10 border-yellow-600/20":"bg-red-600/10 border-red-600/20"),children:[(0,A.jsxs)("div",{className:"flex items-center justify-between",children:[(0,A.jsx)("span",{className:"text-white font-medium",children:e.component}),(0,A.jsx)(c.E,{variant:"outline",className:"".concat("healthy"===e.status?"border-green-500/30 bg-green-500/10 text-green-400":"warning"===e.status?"border-yellow-500/30 bg-yellow-500/10 text-yellow-400":"border-red-500/30 bg-red-500/10 text-red-400"),children:e.status})]}),(0,A.jsx)("p",{className:"text-gray-400 text-sm mt-1",children:e.message})]},s)),(0,A.jsxs)(i.$,{onClick:R,variant:"outline",className:"w-full border-white/20 text-white hover:bg-white/10 mt-3",disabled:E,children:[(0,A.jsx)(f.A,{className:"h-4 w-4 mr-2"}),"Refresh Health Check"]})]})})]}),(0,A.jsx)(o.A,{}),(0,A.jsxs)(r.Zp,{className:"workspace-card",children:[(0,A.jsx)(r.aR,{children:(0,A.jsx)(r.ZB,{className:"text-white",children:"Quick Actions"})}),(0,A.jsx)(r.Wu,{className:"space-y-3",children:(0,A.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,A.jsx)(i.$,{asChild:!0,variant:"outline",className:"border-white/20 text-white hover:bg-white/10",children:(0,A.jsxs)(n.N_,{to:"/admin-setup",children:[(0,A.jsx)(b.A,{className:"h-4 w-4 mr-2"}),"Admin Setup"]})}),a&&(0,A.jsx)(i.$,{asChild:!0,className:"bg-green-600 hover:bg-green-700 text-white",children:(0,A.jsxs)(n.N_,{to:"/admin",children:[(0,A.jsx)(p.A,{className:"h-4 w-4 mr-2"}),"Admin Panel"]})}),(0,A.jsx)(i.$,{asChild:!0,variant:"outline",className:"border-white/20 text-white hover:bg-white/10",children:(0,A.jsxs)(n.N_,{to:"/workspace",children:[(0,A.jsx)(v.A,{className:"h-4 w-4 mr-2"}),"Workspace"]})})]})})]}),(0,A.jsxs)(r.Zp,{className:"workspace-card",children:[(0,A.jsx)(r.aR,{children:(0,A.jsx)(r.ZB,{className:"text-white",children:"Instructions"})}),(0,A.jsx)(r.Wu,{children:(0,A.jsxs)("div",{className:"space-y-3 text-gray-300",children:[(0,A.jsx)("p",{children:(0,A.jsx)("strong",{children:"For ganeshtappiti1605@gmail.com:"})}),(0,A.jsxs)("ol",{className:"list-decimal list-inside space-y-2 ml-4",children:[(0,A.jsx)("li",{children:"Sign in with the admin email address"}),(0,A.jsx)("li",{children:"The system should automatically detect and grant admin access"}),(0,A.jsx)("li",{children:'If not automatic, click "Activate Admin Access" in the verification section above'}),(0,A.jsx)("li",{children:"Once admin access is active, you can access the admin panel"}),(0,A.jsx)("li",{children:'Use the "Admin Panel" link in the sidebar or the button above'})]}),(0,A.jsx)("p",{className:"mt-4",children:(0,A.jsx)("strong",{children:"Troubleshooting:"})}),(0,A.jsxs)("ul",{className:"list-disc list-inside space-y-1 ml-4",children:[(0,A.jsx)("li",{children:"Make sure you're signed in with the correct email"}),(0,A.jsx)("li",{children:"Try refreshing the page if admin status doesn't update"}),(0,A.jsx)("li",{children:"Check the browser console for any errors"}),(0,A.jsx)("li",{children:'Use the "Refresh Status" button to manually update admin status'})]})]})})]})]})})}}}]);