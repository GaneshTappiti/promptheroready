/*! For license information please see 3932.dc2cae9a.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkpromptheroready=self.webpackChunkpromptheroready||[]).push([[3932],{33005:(e,s,t)=>{t.d(s,{A:()=>a});const a=(0,t(77784).A)("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]])},34537:(e,s,t)=>{t.d(s,{A:()=>a});const a=(0,t(77784).A)("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]])},43932:(e,s,t)=>{t.r(s),t.d(s,{default:()=>v});var a=t(65043),r=t(6742),c=t(69772),i=t(8567),n=t(80764),l=t(37719),o=t(75088),d=t(82054),m=t(50516),x=t(33005),h=t(34537),u=t(20073),p=t(44919);const y=(0,t(77784).A)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);var g=t(41736);class w{static async getSlowQueries(){try{const{data:e,error:s}=await g.ND.rpc("get_slow_queries",{threshold_ms:this.SLOW_QUERY_THRESHOLD});return s?(console.warn("Could not fetch slow queries (pg_stat_statements may not be enabled):",s),[]):e||[]}catch(e){return console.warn("Error fetching slow queries:",e),[]}}static async getConnectionStats(){try{const{data:e,error:s}=await g.ND.rpc("get_connection_stats");return s?(console.warn("Could not fetch connection stats:",s),{active:0,idle:0,total:0}):e||{active:0,idle:0,total:0}}catch(e){return console.warn("Error fetching connection stats:",e),{active:0,idle:0,total:0}}}static async getIndexUsage(){try{const{data:e,error:s}=await g.ND.rpc("get_index_usage");return s?(console.warn("Could not fetch index usage:",s),[]):e||[]}catch(e){return console.warn("Error fetching index usage:",e),[]}}static async getPerformanceMetrics(){const[e,s,t]=await Promise.all([this.getSlowQueries(),this.getConnectionStats(),this.getIndexUsage()]);return{slowQueries:e,connectionCount:s.total,cacheHitRatio:0,indexUsage:t}}static analyzeSlowQueries(e){const s=[];for(const t of e){const e=1e3*parseFloat(t.avgTime.replace("s",""));e>5e3?s.push({query:t.query.substring(0,100)+"...",issue:"Very slow query (".concat(t.avgTime," avg)"),recommendation:"Consider adding indexes, optimizing joins, or caching results",priority:"high"}):e>2e3&&s.push({query:t.query.substring(0,100)+"...",issue:"Slow query (".concat(t.avgTime," avg)"),recommendation:"Review query execution plan and consider optimization",priority:"medium"}),(t.query.includes("pg_class")||t.query.includes("pg_namespace")||t.query.includes("pg_get_tabledef")||t.query.includes("pg_get_viewdef"))&&s.push({query:t.query.substring(0,100)+"...",issue:"Expensive schema introspection query",recommendation:"Cache schema information or reduce frequency of schema queries",priority:"high"})}return s}static async generatePerformanceReport(){const e=await this.getPerformanceMetrics(),s=this.analyzeSlowQueries(e.slowQueries),t=e.slowQueries.length>0?e.slowQueries.reduce((e,s)=>e+parseFloat(s.avgTime.replace("s","")),0)/e.slowQueries.length:0;return{metrics:e,recommendations:s,summary:{totalSlowQueries:e.slowQueries.length,highPriorityIssues:s.filter(e=>"high"===e.priority).length,avgQueryTime:t}}}}w.SLOW_QUERY_THRESHOLD=1e3;(()=>{let e})();var j=t(70579);const N=()=>{const[e,s]=(0,a.useState)(null),[t,g]=(0,a.useState)(!1),[N,v]=(0,a.useState)(null),f=async()=>{g(!0);try{const e=await w.generatePerformanceReport(),t=await w.getConnectionStats();s({slowQueries:e.metrics.slowQueries,recommendations:e.recommendations,summary:e.summary,connectionStats:t}),v(new Date)}catch(e){console.error("Failed to fetch performance data:",e)}finally{g(!1)}};(0,a.useEffect)(()=>{f();const e=setInterval(f,3e5);return()=>clearInterval(e)},[]);const b=e=>{switch(e){case"high":return"bg-red-500";case"medium":return"bg-yellow-500";case"low":return"bg-blue-500";default:return"bg-gray-500"}},k=(()=>{if(!e)return{status:"unknown",color:"gray"};const{highPriorityIssues:s,avgQueryTime:t}=e.summary;return s>3||t>3?{status:"critical",color:"red",icon:l.A}:s>0||t>1?{status:"warning",color:"yellow",icon:o.A}:{status:"healthy",color:"green",icon:d.A}})();return(0,j.jsxs)("div",{className:"space-y-6",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Database Performance"}),(0,j.jsx)("p",{className:"text-gray-400",children:"Monitor and optimize database query performance"})]}),(0,j.jsxs)("div",{className:"flex items-center gap-3",children:[N&&(0,j.jsxs)("span",{className:"text-sm text-gray-400",children:["Last updated: ",N.toLocaleTimeString()]}),(0,j.jsxs)(c.$,{onClick:f,disabled:t,variant:"outline",size:"sm",className:"border-white/20 text-white hover:bg-white/10",children:[(0,j.jsx)(m.A,{className:"h-4 w-4 mr-2 ".concat(t?"animate-spin":"")}),"Refresh"]})]})]}),(0,j.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,j.jsx)(r.Zp,{className:"workspace-card",children:(0,j.jsx)(r.Wu,{className:"p-4",children:(0,j.jsxs)("div",{className:"flex items-center justify-between",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("p",{className:"text-sm text-gray-400",children:"System Health"}),(0,j.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,j.jsx)(k.icon,{className:"h-5 w-5 text-".concat(k.color,"-400")}),(0,j.jsx)("span",{className:"text-white font-medium capitalize",children:k.status})]})]}),(0,j.jsx)(x.A,{className:"h-8 w-8 text-blue-400"})]})})}),(0,j.jsx)(r.Zp,{className:"workspace-card",children:(0,j.jsx)(r.Wu,{className:"p-4",children:(0,j.jsxs)("div",{className:"flex items-center justify-between",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("p",{className:"text-sm text-gray-400",children:"Slow Queries"}),(0,j.jsx)("p",{className:"text-2xl font-bold text-white",children:(null===e||void 0===e?void 0:e.summary.totalSlowQueries)||0})]}),(0,j.jsx)(o.A,{className:"h-8 w-8 text-yellow-400"})]})})}),(0,j.jsx)(r.Zp,{className:"workspace-card",children:(0,j.jsx)(r.Wu,{className:"p-4",children:(0,j.jsxs)("div",{className:"flex items-center justify-between",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("p",{className:"text-sm text-gray-400",children:"High Priority Issues"}),(0,j.jsx)("p",{className:"text-2xl font-bold text-white",children:(null===e||void 0===e?void 0:e.summary.highPriorityIssues)||0})]}),(0,j.jsx)(l.A,{className:"h-8 w-8 text-red-400"})]})})}),(0,j.jsx)(r.Zp,{className:"workspace-card",children:(0,j.jsx)(r.Wu,{className:"p-4",children:(0,j.jsxs)("div",{className:"flex items-center justify-between",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("p",{className:"text-sm text-gray-400",children:"Avg Query Time"}),(0,j.jsxs)("p",{className:"text-2xl font-bold text-white",children:[(null===e||void 0===e?void 0:e.summary.avgQueryTime.toFixed(2))||"0.00","s"]})]}),(0,j.jsx)(h.A,{className:"h-8 w-8 text-green-400"})]})})})]}),(null===e||void 0===e?void 0:e.connectionStats)&&(0,j.jsxs)(r.Zp,{className:"workspace-card",children:[(0,j.jsx)(r.aR,{children:(0,j.jsxs)(r.ZB,{className:"text-white flex items-center gap-2",children:[(0,j.jsx)(u.A,{className:"h-5 w-5"}),"Database Connections"]})}),(0,j.jsx)(r.Wu,{children:(0,j.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,j.jsxs)("div",{className:"text-center",children:[(0,j.jsx)("p",{className:"text-2xl font-bold text-green-400",children:e.connectionStats.active}),(0,j.jsx)("p",{className:"text-sm text-gray-400",children:"Active"})]}),(0,j.jsxs)("div",{className:"text-center",children:[(0,j.jsx)("p",{className:"text-2xl font-bold text-blue-400",children:e.connectionStats.idle}),(0,j.jsx)("p",{className:"text-sm text-gray-400",children:"Idle"})]}),(0,j.jsxs)("div",{className:"text-center",children:[(0,j.jsx)("p",{className:"text-2xl font-bold text-white",children:e.connectionStats.total}),(0,j.jsx)("p",{className:"text-sm text-gray-400",children:"Total"})]})]})})]}),(null===e||void 0===e?void 0:e.recommendations)&&e.recommendations.length>0&&(0,j.jsxs)(r.Zp,{className:"workspace-card",children:[(0,j.jsx)(r.aR,{children:(0,j.jsxs)(r.ZB,{className:"text-white flex items-center gap-2",children:[(0,j.jsx)(p.A,{className:"h-5 w-5"}),"Performance Recommendations"]})}),(0,j.jsx)(r.Wu,{className:"space-y-3",children:e.recommendations.slice(0,5).map((e,s)=>(0,j.jsxs)(n.Fc,{className:"border-yellow-600/20 bg-yellow-600/10",children:[(0,j.jsx)(l.A,{className:"h-4 w-4 text-yellow-400"}),(0,j.jsx)(n.TN,{className:"text-yellow-200",children:(0,j.jsx)("div",{className:"flex items-start justify-between",children:(0,j.jsxs)("div",{className:"flex-1",children:[(0,j.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,j.jsx)(i.E,{className:"".concat(b(e.priority)," text-white text-xs"),children:e.priority.toUpperCase()}),(0,j.jsx)("span",{className:"font-medium",children:e.issue})]}),(0,j.jsx)("p",{className:"text-sm",children:e.recommendation}),(0,j.jsx)("p",{className:"text-xs text-yellow-300 mt-1 font-mono",children:e.query})]})})})]},s))})]}),(null===e||void 0===e?void 0:e.slowQueries)&&e.slowQueries.length>0&&(0,j.jsxs)(r.Zp,{className:"workspace-card",children:[(0,j.jsx)(r.aR,{children:(0,j.jsxs)(r.ZB,{className:"text-white flex items-center gap-2",children:[(0,j.jsx)(y,{className:"h-5 w-5"}),"Slow Queries (",e.slowQueries.length,")"]})}),(0,j.jsx)(r.Wu,{children:(0,j.jsx)("div",{className:"space-y-3",children:e.slowQueries.slice(0,10).map((e,s)=>(0,j.jsxs)("div",{className:"border border-white/10 rounded-lg p-3",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,j.jsxs)(i.E,{variant:"outline",className:"text-red-400 border-red-400",children:[e.avgTime," avg"]}),(0,j.jsxs)("span",{className:"text-sm text-gray-400",children:[e.calls," calls"]})]}),(0,j.jsx)("code",{className:"text-xs text-gray-300 block bg-black/20 p-2 rounded",children:e.query.length>200?e.query.substring(0,200)+"...":e.query})]},s))})})]}),!t&&!e&&(0,j.jsx)(r.Zp,{className:"workspace-card",children:(0,j.jsxs)(r.Wu,{className:"text-center py-8",children:[(0,j.jsx)(x.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,j.jsx)("h3",{className:"text-lg font-medium text-white mb-2",children:"No Performance Data"}),(0,j.jsx)("p",{className:"text-gray-400 mb-4",children:"Performance monitoring requires pg_stat_statements extension to be enabled."}),(0,j.jsx)(c.$,{onClick:f,variant:"outline",children:"Try Again"})]})})]})},v=()=>(0,j.jsx)("div",{className:"space-y-6",children:(0,j.jsx)(N,{})})},44919:(e,s,t)=>{t.d(s,{A:()=>a});const a=(0,t(77784).A)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},75088:(e,s,t)=>{t.d(s,{A:()=>a});const a=(0,t(77784).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},82054:(e,s,t)=>{t.d(s,{A:()=>a});const a=(0,t(77784).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])}}]);
//# sourceMappingURL=3932.dc2cae9a.chunk.js.map