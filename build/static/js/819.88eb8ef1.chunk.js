"use strict";(self.webpackChunkpromptheroready=self.webpackChunkpromptheroready||[]).push([[819],{20819:(e,s,a)=>{a.r(s),a.d(s,{default:()=>y});var n=a(9950),i=a(16255),r=a(38493),t=a(60348),d=a(32180);const c=[{role:"super_admin",expectedPermissions:{canManageUsers:!0,canManagePrompts:!0,canManageTools:!0,canViewAnalytics:!0,canManageSettings:!0,canManageRoles:!0,canViewAuditLogs:!0},allowedRoutes:["/admin","/admin/users","/admin/subscriptions","/admin/prompts","/admin/tools","/admin/settings","/admin/roles"],deniedRoutes:[]},{role:"admin",expectedPermissions:{canManageUsers:!1,canManagePrompts:!0,canManageTools:!0,canViewAnalytics:!1,canManageSettings:!1,canManageRoles:!1,canViewAuditLogs:!1},allowedRoutes:["/admin","/admin/prompts","/admin/tools"],deniedRoutes:["/admin/users","/admin/subscriptions","/admin/settings","/admin/roles"]},{role:null,expectedPermissions:{canManageUsers:!1,canManagePrompts:!1,canManageTools:!1,canViewAnalytics:!1,canManageSettings:!1,canManageRoles:!1,canViewAuditLogs:!1},allowedRoutes:[],deniedRoutes:["/admin","/admin/users","/admin/subscriptions","/admin/prompts","/admin/tools","/admin/settings","/admin/roles"]}],l=[{route:"/admin",requiredPermission:void 0,superAdminOnly:!1},{route:"/admin/users",requiredPermission:"canViewAnalytics",superAdminOnly:!0},{route:"/admin/subscriptions",requiredPermission:"canViewAnalytics",superAdminOnly:!1},{route:"/admin/prompts",requiredPermission:"canManagePrompts",superAdminOnly:!1},{route:"/admin/tools",requiredPermission:"canManageTools",superAdminOnly:!1},{route:"/admin/settings",requiredPermission:"canManageSettings",superAdminOnly:!0},{route:"/admin/roles",requiredPermission:"canManageRoles",superAdminOnly:!0}];function o(e,s,a){if(!e||"admin"!==e&&"super_admin"!==e)return!1;const n=l.find(e=>e.route===a);return!!n&&((!n.superAdminOnly||"super_admin"===e)&&!(n.requiredPermission&&!s[n.requiredPermission]))}function m(){const e=[];let s=0,a=0;return c.forEach(n=>{const{role:i,expectedPermissions:r,allowedRoutes:t,deniedRoutes:d}=n;t.forEach(n=>{const t=o(i,r,n),d={role:i,route:n,expected:!0,actual:t,passed:!0===t};e.push(d),d.passed?s++:a++}),d.forEach(n=>{const t=o(i,r,n),d={role:i,route:n,expected:!1,actual:t,passed:!1===t};e.push(d),d.passed?s++:a++})}),{passed:s,failed:a,results:e}}function x(){const{passed:e,failed:s,results:a}=m();let n="\n=== Admin Permission Test Report ===\n";return n+="Total Tests: ".concat(e+s,"\n"),n+="Passed: ".concat(e,"\n"),n+="Failed: ".concat(s,"\n"),n+="Success Rate: ".concat((e/(e+s)*100).toFixed(1),"%\n\n"),s>0&&(n+="Failed Tests:\n",a.filter(e=>!e.passed).forEach(e=>{const s=e;n+="- ".concat(s.role||"non-admin"," accessing ").concat(s.route,": expected ").concat(s.expected,", got ").concat(s.actual,"\n")})),n+="\n=== Route Permission Configuration ===\n",l.forEach(e=>{n+="".concat(e.route,":\n"),n+="  - Required Permission: ".concat(e.requiredPermission||"none","\n"),n+="  - Super Admin Only: ".concat(e.superAdminOnly,"\n")}),n}"undefined"!==typeof window&&(window.adminPermissionTest={runTests:m,generateReport:x,canAccessRoute:o,testCases:c,routePermissions:l});var u=a(81946),p=a(45833),h=a(81850),g=a(57594),j=a(15924),N=a(44414);const y=()=>{const{adminUser:e,isAdmin:s,isSuperAdmin:a,permissions:c,checkPermission:y}=(0,d.z8)(),[v,f]=(0,n.useState)(null),A=e?l.map(s=>({route:s.route,canAccess:o(e.role,c,s.route),requiredPermission:s.requiredPermission,superAdminOnly:s.superAdminOnly,hasPermission:!s.requiredPermission||y(s.requiredPermission)})):[];return(0,N.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 p-6",children:(0,N.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,N.jsxs)("div",{className:"text-center",children:[(0,N.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"Admin Permission Test"}),(0,N.jsx)("p",{className:"text-gray-400",children:"Test and validate the admin permission system"})]}),(0,N.jsxs)(i.Zp,{className:"bg-gray-800/50 border-gray-700",children:[(0,N.jsx)(i.aR,{children:(0,N.jsxs)(i.ZB,{className:"text-white flex items-center gap-2",children:[(0,N.jsx)(u.A,{className:"h-5 w-5"}),"Current User Status"]})}),(0,N.jsxs)(i.Wu,{className:"space-y-4",children:[(0,N.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("p",{className:"text-gray-400 text-sm",children:"Email"}),(0,N.jsx)("p",{className:"text-white",children:(null===e||void 0===e?void 0:e.email)||"Not logged in"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("p",{className:"text-gray-400 text-sm",children:"Role"}),(0,N.jsx)(t.E,{variant:"super_admin"===(null===e||void 0===e?void 0:e.role)?"default":"secondary",children:(null===e||void 0===e?void 0:e.role)||"none"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("p",{className:"text-gray-400 text-sm",children:"Is Admin"}),(0,N.jsx)(t.E,{variant:s?"default":"destructive",children:s?"Yes":"No"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("p",{className:"text-gray-400 text-sm",children:"Is Super Admin"}),(0,N.jsx)(t.E,{variant:a?"default":"destructive",children:a?"Yes":"No"})]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("p",{className:"text-gray-400 text-sm mb-2",children:"Permissions"}),(0,N.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:Object.entries(c).map(e=>{let[s,a]=e;return(0,N.jsxs)(t.E,{variant:a?"default":"secondary",className:"text-xs",children:[s,": ",a?"Yes":"No"]},s)})})]})]})]}),(0,N.jsxs)(i.Zp,{className:"bg-gray-800/50 border-gray-700",children:[(0,N.jsx)(i.aR,{children:(0,N.jsx)(i.ZB,{className:"text-white",children:"Route Access Test (Current User)"})}),(0,N.jsx)(i.Wu,{children:(0,N.jsx)("div",{className:"space-y-2",children:A.map((e,s)=>(0,N.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-700/30 rounded-lg",children:[(0,N.jsxs)("div",{className:"flex items-center gap-3",children:[e.canAccess?(0,N.jsx)(p.A,{className:"h-5 w-5 text-green-400"}):(0,N.jsx)(h.A,{className:"h-5 w-5 text-red-400"}),(0,N.jsx)("span",{className:"text-white font-mono",children:e.route})]}),(0,N.jsxs)("div",{className:"flex items-center gap-2",children:[e.superAdminOnly&&(0,N.jsx)(t.E,{variant:"outline",className:"text-xs",children:"Super Admin Only"}),e.requiredPermission&&(0,N.jsx)(t.E,{variant:e.hasPermission?"default":"destructive",className:"text-xs",children:e.requiredPermission}),(0,N.jsx)(t.E,{variant:e.canAccess?"default":"destructive",children:e.canAccess?"Allowed":"Denied"})]})]},s))})})]}),(0,N.jsxs)(i.Zp,{className:"bg-gray-800/50 border-gray-700",children:[(0,N.jsx)(i.aR,{children:(0,N.jsxs)(i.ZB,{className:"text-white flex items-center gap-2",children:[(0,N.jsx)(g.A,{className:"h-5 w-5"}),"Permission System Tests"]})}),(0,N.jsxs)(i.Wu,{className:"space-y-4",children:[(0,N.jsx)(r.$,{onClick:()=>{const e=m();f(e)},className:"w-full",children:"Run Comprehensive Permission Tests"}),v&&(0,N.jsxs)("div",{className:"space-y-4",children:[(0,N.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,N.jsxs)("div",{className:"text-center",children:[(0,N.jsx)("p",{className:"text-2xl font-bold text-green-400",children:v.passed}),(0,N.jsx)("p",{className:"text-gray-400 text-sm",children:"Passed"})]}),(0,N.jsxs)("div",{className:"text-center",children:[(0,N.jsx)("p",{className:"text-2xl font-bold text-red-400",children:v.failed}),(0,N.jsx)("p",{className:"text-gray-400 text-sm",children:"Failed"})]}),(0,N.jsxs)("div",{className:"text-center",children:[(0,N.jsxs)("p",{className:"text-2xl font-bold text-blue-400",children:[(v.passed/(v.passed+v.failed)*100).toFixed(1),"%"]}),(0,N.jsx)("p",{className:"text-gray-400 text-sm",children:"Success Rate"})]})]}),v.failed>0&&(0,N.jsxs)("div",{className:"bg-red-900/20 border border-red-500/30 rounded-lg p-4",children:[(0,N.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,N.jsx)(j.A,{className:"h-5 w-5 text-red-400"}),(0,N.jsx)("h3",{className:"text-red-400 font-semibold",children:"Failed Tests"})]}),(0,N.jsx)("div",{className:"space-y-1",children:v.results.filter(e=>!e.passed).map((e,s)=>{var a,n;return(0,N.jsxs)("p",{className:"text-red-300 text-sm font-mono",children:[e.role||"non-admin"," accessing ",e.route,": expected ",null===(a=e.expected)||void 0===a?void 0:a.toString(),", got ",null===(n=e.actual)||void 0===n?void 0:n.toString()]},s)})})]}),(0,N.jsxs)("div",{className:"bg-gray-700/30 rounded-lg p-4",children:[(0,N.jsx)("h3",{className:"text-white font-semibold mb-2",children:"Test Report"}),(0,N.jsx)("pre",{className:"text-gray-300 text-xs overflow-x-auto whitespace-pre-wrap",children:x()})]})]})]})]})]})})}}}]);